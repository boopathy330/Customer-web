{"ast":null,"code":"export function authHeader() {\n  // return authorization header with jwt token\n  const token = window.localStorage.getItem(\"token\");\n\n  if (token) {\n    return {\n      \"Content-Type\": \"application/json\",\n      Authorization: \"Bearer \" + token\n    };\n  } else {\n    return {};\n  }\n}\nexport function checkRefresh() {\n  const expiresIn = window.localStorage.getItem(\"expiresIn\");\n  const userName = window.localStorage.getItem(\"username\");\n  const refreshToken = window.localStorage.getItem(\"refreshToken\");\n\n  if (refreshToken && expiresIn) {\n    const time = new Date(expiresIn); //refresh 5 minutes before token expires in\n\n    time.setMinutes(time.getMinutes - 5);\n    const now = new Date();\n\n    if (time < now) {\n      const headers = authHeader();\n      const requestOptions = {\n        method: \"POST\",\n        headers,\n        body: {\n          user_name: userName,\n          refresh_token: refreshToken,\n          grant_type: \"refresh_token\"\n        }\n      };\n      return window.fetch(`http://localhost:3001/v1/user/auth/toke`, requestOptions).then(handleResponse).then(data => {\n        return data;\n      });\n    }\n  }\n}\nexport function handleResponse(response) {\n  return response.text().then(text => {\n    const data = text && JSON.parse(text);\n    return data;\n  });\n}","map":{"version":3,"sources":["/home/boopathy/work/learnings/Project/src/Utils/auth-header.js"],"names":["authHeader","token","window","localStorage","getItem","Authorization","checkRefresh","expiresIn","userName","refreshToken","time","Date","setMinutes","getMinutes","now","headers","requestOptions","method","body","user_name","refresh_token","grant_type","fetch","then","handleResponse","data","response","text","JSON","parse"],"mappings":"AAAA,OAAO,SAASA,UAAT,GAAsB;AAC3B;AACA,QAAMC,KAAK,GAAGC,MAAM,CAACC,YAAP,CAAoBC,OAApB,CAA4B,OAA5B,CAAd;;AAEA,MAAIH,KAAJ,EAAW;AACT,WAAO;AACL,sBAAgB,kBADX;AAELI,MAAAA,aAAa,EAAE,YAAYJ;AAFtB,KAAP;AAID,GALD,MAKO;AACL,WAAO,EAAP;AACD;AACF;AAED,OAAO,SAASK,YAAT,GAAwB;AAC7B,QAAMC,SAAS,GAAGL,MAAM,CAACC,YAAP,CAAoBC,OAApB,CAA4B,WAA5B,CAAlB;AACA,QAAMI,QAAQ,GAAGN,MAAM,CAACC,YAAP,CAAoBC,OAApB,CAA4B,UAA5B,CAAjB;AACA,QAAMK,YAAY,GAAGP,MAAM,CAACC,YAAP,CAAoBC,OAApB,CAA4B,cAA5B,CAArB;;AACA,MAAIK,YAAY,IAAIF,SAApB,EAA+B;AAC7B,UAAMG,IAAI,GAAG,IAAIC,IAAJ,CAASJ,SAAT,CAAb,CAD6B,CAE7B;;AACAG,IAAAA,IAAI,CAACE,UAAL,CAAgBF,IAAI,CAACG,UAAL,GAAkB,CAAlC;AACA,UAAMC,GAAG,GAAG,IAAIH,IAAJ,EAAZ;;AACA,QAAID,IAAI,GAAGI,GAAX,EAAgB;AACd,YAAMC,OAAO,GAAGf,UAAU,EAA1B;AACA,YAAMgB,cAAc,GAAG;AACrBC,QAAAA,MAAM,EAAE,MADa;AAErBF,QAAAA,OAFqB;AAGrBG,QAAAA,IAAI,EAAE;AACJC,UAAAA,SAAS,EAAEX,QADP;AAEJY,UAAAA,aAAa,EAAEX,YAFX;AAGJY,UAAAA,UAAU,EAAE;AAHR;AAHe,OAAvB;AASA,aAAOnB,MAAM,CACVoB,KADI,CACG,yCADH,EAC6CN,cAD7C,EAEJO,IAFI,CAECC,cAFD,EAGJD,IAHI,CAGEE,IAAD,IAAU;AACd,eAAOA,IAAP;AACD,OALI,CAAP;AAMD;AACF;AACF;AAED,OAAO,SAASD,cAAT,CAAwBE,QAAxB,EAAkC;AACvC,SAAOA,QAAQ,CAACC,IAAT,GAAgBJ,IAAhB,CAAsBI,IAAD,IAAU;AACpC,UAAMF,IAAI,GAAGE,IAAI,IAAIC,IAAI,CAACC,KAAL,CAAWF,IAAX,CAArB;AACA,WAAOF,IAAP;AACD,GAHM,CAAP;AAID","sourcesContent":["export function authHeader() {\r\n  // return authorization header with jwt token\r\n  const token = window.localStorage.getItem(\"token\");\r\n\r\n  if (token) {\r\n    return {\r\n      \"Content-Type\": \"application/json\",\r\n      Authorization: \"Bearer \" + token,\r\n    };\r\n  } else {\r\n    return {};\r\n  }\r\n}\r\n\r\nexport function checkRefresh() {\r\n  const expiresIn = window.localStorage.getItem(\"expiresIn\");\r\n  const userName = window.localStorage.getItem(\"username\");\r\n  const refreshToken = window.localStorage.getItem(\"refreshToken\");\r\n  if (refreshToken && expiresIn) {\r\n    const time = new Date(expiresIn);\r\n    //refresh 5 minutes before token expires in\r\n    time.setMinutes(time.getMinutes - 5);\r\n    const now = new Date();\r\n    if (time < now) {\r\n      const headers = authHeader();\r\n      const requestOptions = {\r\n        method: \"POST\",\r\n        headers,\r\n        body: {\r\n          user_name: userName,\r\n          refresh_token: refreshToken,\r\n          grant_type: \"refresh_token\",\r\n        },\r\n      };\r\n      return window\r\n        .fetch(`http://localhost:3001/v1/user/auth/toke`, requestOptions)\r\n        .then(handleResponse)\r\n        .then((data) => {\r\n          return data;\r\n        });\r\n    }\r\n  }\r\n}\r\n\r\nexport function handleResponse(response) {\r\n  return response.text().then((text) => {\r\n    const data = text && JSON.parse(text);\r\n    return data;\r\n  });\r\n}\r\n"]},"metadata":{},"sourceType":"module"}