{"ast":null,"code":"import { authConstants } from \"../Constants\";\nimport { authService } from \"../Services\";\nimport { history } from \"../Helpers/history\";\n\nconst login = (email, password) => {\n  return dispatch => {\n    authService.login(email, password).then(result => {\n      if (result.status === 400 || result.status === 401) {\n        dispatch({\n          type: authConstants.LOAD_ERROR_MSG,\n          payload: {\n            status: result.status,\n            message: result.message\n          }\n        });\n      } else {\n        dispatch({\n          type: authConstants.LOAD_USER_PROFILE,\n          payload: {\n            id: result._id,\n            username: result.username,\n            role: result.role\n          }\n        });\n        window.sessionStorage.setItem(\"token\", result.accessToken);\n        window.localStorage.setItem(\"refreshToken\", result.refreshToken);\n        window.localStorage.setItem(\"expiresIn\", result.expiresIn);\n        window.sessionStorage.setItem(\"userId\", result.userId);\n        window.sessionStorage.setItem(\"username\", result.username);\n        window.sessionStorage.setItem(\"role\", result.role);\n      }\n    });\n    return Promise.resolve;\n  };\n};\n\nconst setAuth = () => {\n  return dispatch => {\n    try {\n      const {\n        token,\n        user\n      } = authService.checkAuth();\n\n      if (token && user) {\n        const userData = JSON.parse(user);\n        dispatch({\n          type: authConstants.LOAD_USER_PROFILE,\n          payload: {\n            id: userData._id,\n            username: userData.username\n          }\n        });\n      } else {\n        dispatch({\n          type: authConstants.REMOVE_USER_PROFILE\n        });\n      }\n    } catch (err) {\n      dispatch({\n        type: authConstants.REMOVE_USER_PROFILE\n      });\n      console.log(err, \"from auth.actions\");\n    }\n  };\n};\n\nconst logout = () => {\n  return dispatch => {\n    console.log(\"from function\");\n    authService.logout();\n    history.push(\"/\");\n    dispatch({\n      type: authConstants.REMOVE_USER_PROFILE\n    });\n  };\n};\n\nexport const authActions = {\n  login,\n  logout,\n  setAuth\n};","map":{"version":3,"sources":["/home/boopathy/work/learnings/Project/src/Actions/auth.actions.js"],"names":["authConstants","authService","history","login","email","password","dispatch","then","result","status","type","LOAD_ERROR_MSG","payload","message","LOAD_USER_PROFILE","id","_id","username","role","window","sessionStorage","setItem","accessToken","localStorage","refreshToken","expiresIn","userId","Promise","resolve","setAuth","token","user","checkAuth","userData","JSON","parse","REMOVE_USER_PROFILE","err","console","log","logout","push","authActions"],"mappings":"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","sourcesContent":["import { authConstants } from \"../Constants\";\r\nimport { authService } from \"../Services\";\r\nimport { history } from \"../Helpers/history\";\r\n\r\nconst login = (email, password) => {\r\n  return (dispatch) => {\r\n    authService.login(email, password).then((result) => {\r\n      if (result.status === 400 || result.status === 401) {\r\n        dispatch({\r\n          type: authConstants.LOAD_ERROR_MSG,\r\n          payload: {\r\n            status: result.status,\r\n            message: result.message,\r\n          },\r\n        });\r\n      } else {\r\n        dispatch({\r\n          type: authConstants.LOAD_USER_PROFILE,\r\n          payload: {\r\n            id: result._id,\r\n            username: result.username,\r\n            role: result.role,\r\n          },\r\n        });\r\n        window.sessionStorage.setItem(\"token\", result.accessToken);\r\n        window.localStorage.setItem(\"refreshToken\", result.refreshToken);\r\n        window.localStorage.setItem(\"expiresIn\", result.expiresIn);\r\n        window.sessionStorage.setItem(\"userId\", result.userId);\r\n        window.sessionStorage.setItem(\"username\", result.username);\r\n        window.sessionStorage.setItem(\"role\", result.role);\r\n      }\r\n    });\r\n\r\n    return Promise.resolve;\r\n  };\r\n};\r\nconst setAuth = () => {\r\n  return (dispatch) => {\r\n    try {\r\n      const { token, user } = authService.checkAuth();\r\n      if (token && user) {\r\n        const userData = JSON.parse(user);\r\n        dispatch({\r\n          type: authConstants.LOAD_USER_PROFILE,\r\n          payload: {\r\n            id: userData._id,\r\n            username: userData.username,\r\n          },\r\n        });\r\n      } else {\r\n        dispatch({ type: authConstants.REMOVE_USER_PROFILE });\r\n      }\r\n    } catch (err) {\r\n      dispatch({ type: authConstants.REMOVE_USER_PROFILE });\r\n      console.log(err, \"from auth.actions\");\r\n    }\r\n  };\r\n};\r\nconst logout = () => {\r\n  return (dispatch) => {\r\n    console.log(\"from function\");\r\n    authService.logout();\r\n    history.push(\"/\");\r\n    dispatch({\r\n      type: authConstants.REMOVE_USER_PROFILE,\r\n    });\r\n  };\r\n};\r\nexport const authActions = {\r\n  login,\r\n  logout,\r\n  setAuth,\r\n};\r\n"]},"metadata":{},"sourceType":"module"}