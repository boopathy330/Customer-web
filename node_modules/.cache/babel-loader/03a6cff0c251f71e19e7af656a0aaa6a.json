{"ast":null,"code":"import { config } from \"../Constants\";\nimport { authHeader } from \"../Utils/auth-header\";\n\nconst login = (username, password) => {\n  const requestOptions = {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\"\n    },\n    body: JSON.stringify({\n      user_name: username,\n      password: password,\n      grant_type: \"password\"\n    })\n  };\n  return window.fetch(`http://localhost:3001/v1/user/auth/token`, requestOptions).then(handleResponse).then(result => {\n    console.log(\"response\", result);\n\n    if (result.error.status === 400) {\n      return result.error;\n    } else {\n      return result;\n    }\n  });\n};\n\nconst checkAuth = () => {\n  try {\n    const token = window.localStorage.getItem(\"token\");\n    const user = window.localStorage.getItem(\"user\");\n\n    if (token && user) {\n      return {\n        token,\n        user\n      };\n    } else {\n      const token = false;\n      const user = false;\n      return {\n        token,\n        user\n      };\n    }\n  } catch (err) {\n    console.log(err);\n    return Error;\n  }\n};\n\nconst logout = () => {\n  // remove user from local storage to log user out\n  const headers = authHeader();\n  const requestOptions = {\n    method: \"PUT\",\n    headers\n  };\n  return window.fetch(`https://localhost:3001/v1/users/revoke/token`, requestOptions).then(handleResponse).then(data => {\n    window.localStorage.removeItem(\"token\");\n    window.localStorage.removeItem(\"user\");\n    return Promise.resolve;\n  });\n};\n\nfunction handleResponse(response) {\n  return response.text().then(text => {\n    const data = text && JSON.parse(text);\n    return data;\n  });\n}\n\nexport const authService = {\n  login,\n  logout,\n  checkAuth\n};","map":{"version":3,"sources":["/home/boopathy/work/learnings/Project/src/Services/auth.service.js"],"names":["config","authHeader","login","username","password","requestOptions","method","headers","body","JSON","stringify","user_name","grant_type","window","fetch","then","handleResponse","result","console","log","error","status","checkAuth","token","localStorage","getItem","user","err","Error","logout","data","removeItem","Promise","resolve","response","text","parse","authService"],"mappings":"AAAA,SAASA,MAAT,QAAuB,cAAvB;AACA,SAASC,UAAT,QAA2B,sBAA3B;;AAEA,MAAMC,KAAK,GAAG,CAACC,QAAD,EAAWC,QAAX,KAAwB;AACpC,QAAMC,cAAc,GAAG;AACrBC,IAAAA,MAAM,EAAE,MADa;AAErBC,IAAAA,OAAO,EAAE;AAAE,sBAAgB;AAAlB,KAFY;AAGrBC,IAAAA,IAAI,EAAEC,IAAI,CAACC,SAAL,CAAe;AACnBC,MAAAA,SAAS,EAAER,QADQ;AAEnBC,MAAAA,QAAQ,EAAEA,QAFS;AAGnBQ,MAAAA,UAAU,EAAE;AAHO,KAAf;AAHe,GAAvB;AASA,SAAOC,MAAM,CACVC,KADI,CACG,0CADH,EAC8CT,cAD9C,EAEJU,IAFI,CAECC,cAFD,EAGJD,IAHI,CAGEE,MAAD,IAAY;AAChBC,IAAAA,OAAO,CAACC,GAAR,CAAY,UAAZ,EAAwBF,MAAxB;;AACA,QAAIA,MAAM,CAACG,KAAP,CAAaC,MAAb,KAAwB,GAA5B,EAAiC;AAC/B,aAAOJ,MAAM,CAACG,KAAd;AACD,KAFD,MAEO;AACL,aAAOH,MAAP;AACD;AACF,GAVI,CAAP;AAWD,CArBD;;AAuBA,MAAMK,SAAS,GAAG,MAAM;AACtB,MAAI;AACF,UAAMC,KAAK,GAAGV,MAAM,CAACW,YAAP,CAAoBC,OAApB,CAA4B,OAA5B,CAAd;AACA,UAAMC,IAAI,GAAGb,MAAM,CAACW,YAAP,CAAoBC,OAApB,CAA4B,MAA5B,CAAb;;AACA,QAAIF,KAAK,IAAIG,IAAb,EAAmB;AACjB,aAAO;AAAEH,QAAAA,KAAF;AAASG,QAAAA;AAAT,OAAP;AACD,KAFD,MAEO;AACL,YAAMH,KAAK,GAAG,KAAd;AACA,YAAMG,IAAI,GAAG,KAAb;AACA,aAAO;AAAEH,QAAAA,KAAF;AAASG,QAAAA;AAAT,OAAP;AACD;AACF,GAVD,CAUE,OAAOC,GAAP,EAAY;AACZT,IAAAA,OAAO,CAACC,GAAR,CAAYQ,GAAZ;AACA,WAAOC,KAAP;AACD;AACF,CAfD;;AAiBA,MAAMC,MAAM,GAAG,MAAM;AACnB;AACA,QAAMtB,OAAO,GAAGN,UAAU,EAA1B;AACA,QAAMI,cAAc,GAAG;AACrBC,IAAAA,MAAM,EAAE,KADa;AAErBC,IAAAA;AAFqB,GAAvB;AAKA,SAAOM,MAAM,CACVC,KADI,CACG,8CADH,EACkDT,cADlD,EAEJU,IAFI,CAECC,cAFD,EAGJD,IAHI,CAGEe,IAAD,IAAU;AACdjB,IAAAA,MAAM,CAACW,YAAP,CAAoBO,UAApB,CAA+B,OAA/B;AACAlB,IAAAA,MAAM,CAACW,YAAP,CAAoBO,UAApB,CAA+B,MAA/B;AACA,WAAOC,OAAO,CAACC,OAAf;AACD,GAPI,CAAP;AAQD,CAhBD;;AAkBA,SAASjB,cAAT,CAAwBkB,QAAxB,EAAkC;AAChC,SAAOA,QAAQ,CAACC,IAAT,GAAgBpB,IAAhB,CAAsBoB,IAAD,IAAU;AACpC,UAAML,IAAI,GAAGK,IAAI,IAAI1B,IAAI,CAAC2B,KAAL,CAAWD,IAAX,CAArB;AACA,WAAOL,IAAP;AACD,GAHM,CAAP;AAID;;AAED,OAAO,MAAMO,WAAW,GAAG;AACzBnC,EAAAA,KADyB;AAEzB2B,EAAAA,MAFyB;AAGzBP,EAAAA;AAHyB,CAApB","sourcesContent":["import { config } from \"../Constants\";\r\nimport { authHeader } from \"../Utils/auth-header\";\r\n\r\nconst login = (username, password) => {\r\n  const requestOptions = {\r\n    method: \"POST\",\r\n    headers: { \"Content-Type\": \"application/json\" },\r\n    body: JSON.stringify({\r\n      user_name: username,\r\n      password: password,\r\n      grant_type: \"password\",\r\n    }),\r\n  };\r\n  return window\r\n    .fetch(`http://localhost:3001/v1/user/auth/token`, requestOptions)\r\n    .then(handleResponse)\r\n    .then((result) => {\r\n      console.log(\"response\", result);\r\n      if (result.error.status === 400) {\r\n        return result.error;\r\n      } else {\r\n        return result;\r\n      }\r\n    });\r\n};\r\n\r\nconst checkAuth = () => {\r\n  try {\r\n    const token = window.localStorage.getItem(\"token\");\r\n    const user = window.localStorage.getItem(\"user\");\r\n    if (token && user) {\r\n      return { token, user };\r\n    } else {\r\n      const token = false;\r\n      const user = false;\r\n      return { token, user };\r\n    }\r\n  } catch (err) {\r\n    console.log(err);\r\n    return Error;\r\n  }\r\n};\r\n\r\nconst logout = () => {\r\n  // remove user from local storage to log user out\r\n  const headers = authHeader();\r\n  const requestOptions = {\r\n    method: \"PUT\",\r\n    headers,\r\n  };\r\n\r\n  return window\r\n    .fetch(`https://localhost:3001/v1/users/revoke/token`, requestOptions)\r\n    .then(handleResponse)\r\n    .then((data) => {\r\n      window.localStorage.removeItem(\"token\");\r\n      window.localStorage.removeItem(\"user\");\r\n      return Promise.resolve;\r\n    });\r\n};\r\n\r\nfunction handleResponse(response) {\r\n  return response.text().then((text) => {\r\n    const data = text && JSON.parse(text);\r\n    return data;\r\n  });\r\n}\r\n\r\nexport const authService = {\r\n  login,\r\n  logout,\r\n  checkAuth,\r\n};\r\n"]},"metadata":{},"sourceType":"module"}