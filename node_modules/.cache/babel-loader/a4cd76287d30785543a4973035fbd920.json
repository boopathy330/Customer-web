{"ast":null,"code":"import { config } from \"../Constants\";\nimport { authHeader } from \"../Utils/auth-header\";\n\nconst login = (username, password) => {\n  const requestOptions = {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\"\n    },\n    body: JSON.stringify({\n      user_name: username,\n      password: password,\n      grant_type: \"password\"\n    })\n  };\n  return window.fetch(`${config.CUSTOMER_SERV}/v1/user/auth/token`, requestOptions).then(handleResponse).then(result => {\n    console.log(\"response\", result);\n\n    if (result && result.error && result.error.status === 400) {\n      return result.error;\n    } else {\n      return result;\n    }\n  });\n};\n\nconst checkAuth = () => {\n  try {\n    const token = window.sessionStorage.getItem(\"token\");\n    const user = {\n      userId: window.localStorage.getItem(\"userId\"),\n      username: window.localStorage.getItem(\"userName\")\n    };\n\n    if (token && user) {\n      return {\n        token,\n        user\n      };\n    } else {\n      const token = false;\n      const user = false;\n      return {\n        token,\n        user\n      };\n    }\n  } catch (err) {\n    console.log(err);\n    return Error;\n  }\n};\n\nconst logout = () => {\n  // remove user from local storage to log user out\n  const headers = authHeader();\n  const requestOptions = {\n    method: \"POST\",\n    headers\n  };\n  return window.fetch(`${config.CUSTOMER_SERV}/v1/user/revoke/token`, requestOptions).then(handleResponse).then(data => {\n    return Promise.resolve;\n  });\n};\n\nfunction handleResponse(response) {\n  return response.text().then(text => {\n    const data = text && JSON.parse(text);\n    return data;\n  });\n}\n\nexport const authService = {\n  login,\n  logout,\n  checkAuth\n};","map":{"version":3,"sources":["/home/boopathy/work/learnings/customer-transaction/customer-web/src/Services/auth.service.js"],"names":["config","authHeader","login","username","password","requestOptions","method","headers","body","JSON","stringify","user_name","grant_type","window","fetch","CUSTOMER_SERV","then","handleResponse","result","console","log","error","status","checkAuth","token","sessionStorage","getItem","user","userId","localStorage","err","Error","logout","data","Promise","resolve","response","text","parse","authService"],"mappings":"AAAA,SAASA,MAAT,QAAuB,cAAvB;AACA,SAASC,UAAT,QAA2B,sBAA3B;;AAEA,MAAMC,KAAK,GAAG,CAACC,QAAD,EAAWC,QAAX,KAAwB;AACpC,QAAMC,cAAc,GAAG;AACrBC,IAAAA,MAAM,EAAE,MADa;AAErBC,IAAAA,OAAO,EAAE;AAAE,sBAAgB;AAAlB,KAFY;AAGrBC,IAAAA,IAAI,EAAEC,IAAI,CAACC,SAAL,CAAe;AACnBC,MAAAA,SAAS,EAAER,QADQ;AAEnBC,MAAAA,QAAQ,EAAEA,QAFS;AAGnBQ,MAAAA,UAAU,EAAE;AAHO,KAAf;AAHe,GAAvB;AASA,SAAOC,MAAM,CACVC,KADI,CACG,GAAEd,MAAM,CAACe,aAAc,qBAD1B,EACgDV,cADhD,EAEJW,IAFI,CAECC,cAFD,EAGJD,IAHI,CAGEE,MAAD,IAAY;AAChBC,IAAAA,OAAO,CAACC,GAAR,CAAY,UAAZ,EAAwBF,MAAxB;;AACA,QAAIA,MAAM,IAAIA,MAAM,CAACG,KAAjB,IAA0BH,MAAM,CAACG,KAAP,CAAaC,MAAb,KAAwB,GAAtD,EAA2D;AACzD,aAAOJ,MAAM,CAACG,KAAd;AACD,KAFD,MAEO;AACL,aAAOH,MAAP;AACD;AACF,GAVI,CAAP;AAWD,CArBD;;AAuBA,MAAMK,SAAS,GAAG,MAAM;AACtB,MAAI;AACF,UAAMC,KAAK,GAAGX,MAAM,CAACY,cAAP,CAAsBC,OAAtB,CAA8B,OAA9B,CAAd;AACA,UAAMC,IAAI,GAAG;AACXC,MAAAA,MAAM,EAAEf,MAAM,CAACgB,YAAP,CAAoBH,OAApB,CAA4B,QAA5B,CADG;AAEXvB,MAAAA,QAAQ,EAAEU,MAAM,CAACgB,YAAP,CAAoBH,OAApB,CAA4B,UAA5B;AAFC,KAAb;;AAIA,QAAIF,KAAK,IAAIG,IAAb,EAAmB;AACjB,aAAO;AAAEH,QAAAA,KAAF;AAASG,QAAAA;AAAT,OAAP;AACD,KAFD,MAEO;AACL,YAAMH,KAAK,GAAG,KAAd;AACA,YAAMG,IAAI,GAAG,KAAb;AACA,aAAO;AAAEH,QAAAA,KAAF;AAASG,QAAAA;AAAT,OAAP;AACD;AACF,GAbD,CAaE,OAAOG,GAAP,EAAY;AACZX,IAAAA,OAAO,CAACC,GAAR,CAAYU,GAAZ;AACA,WAAOC,KAAP;AACD;AACF,CAlBD;;AAoBA,MAAMC,MAAM,GAAG,MAAM;AACnB;AACA,QAAMzB,OAAO,GAAGN,UAAU,EAA1B;AACA,QAAMI,cAAc,GAAG;AACrBC,IAAAA,MAAM,EAAE,MADa;AAErBC,IAAAA;AAFqB,GAAvB;AAKA,SAAOM,MAAM,CACVC,KADI,CACG,GAAEd,MAAM,CAACe,aAAc,uBAD1B,EACkDV,cADlD,EAEJW,IAFI,CAECC,cAFD,EAGJD,IAHI,CAGEiB,IAAD,IAAU;AACd,WAAOC,OAAO,CAACC,OAAf;AACD,GALI,CAAP;AAMD,CAdD;;AAgBA,SAASlB,cAAT,CAAwBmB,QAAxB,EAAkC;AAChC,SAAOA,QAAQ,CAACC,IAAT,GAAgBrB,IAAhB,CAAsBqB,IAAD,IAAU;AACpC,UAAMJ,IAAI,GAAGI,IAAI,IAAI5B,IAAI,CAAC6B,KAAL,CAAWD,IAAX,CAArB;AACA,WAAOJ,IAAP;AACD,GAHM,CAAP;AAID;;AAED,OAAO,MAAMM,WAAW,GAAG;AACzBrC,EAAAA,KADyB;AAEzB8B,EAAAA,MAFyB;AAGzBT,EAAAA;AAHyB,CAApB","sourcesContent":["import { config } from \"../Constants\";\r\nimport { authHeader } from \"../Utils/auth-header\";\r\n\r\nconst login = (username, password) => {\r\n  const requestOptions = {\r\n    method: \"POST\",\r\n    headers: { \"Content-Type\": \"application/json\" },\r\n    body: JSON.stringify({\r\n      user_name: username,\r\n      password: password,\r\n      grant_type: \"password\",\r\n    }),\r\n  };\r\n  return window\r\n    .fetch(`${config.CUSTOMER_SERV}/v1/user/auth/token`, requestOptions)\r\n    .then(handleResponse)\r\n    .then((result) => {\r\n      console.log(\"response\", result);\r\n      if (result && result.error && result.error.status === 400) {\r\n        return result.error;\r\n      } else {\r\n        return result;\r\n      }\r\n    });\r\n};\r\n\r\nconst checkAuth = () => {\r\n  try {\r\n    const token = window.sessionStorage.getItem(\"token\");\r\n    const user = {\r\n      userId: window.localStorage.getItem(\"userId\"),\r\n      username: window.localStorage.getItem(\"userName\"),\r\n    };\r\n    if (token && user) {\r\n      return { token, user };\r\n    } else {\r\n      const token = false;\r\n      const user = false;\r\n      return { token, user };\r\n    }\r\n  } catch (err) {\r\n    console.log(err);\r\n    return Error;\r\n  }\r\n};\r\n\r\nconst logout = () => {\r\n  // remove user from local storage to log user out\r\n  const headers = authHeader();\r\n  const requestOptions = {\r\n    method: \"POST\",\r\n    headers,\r\n  };\r\n\r\n  return window\r\n    .fetch(`${config.CUSTOMER_SERV}/v1/user/revoke/token`, requestOptions)\r\n    .then(handleResponse)\r\n    .then((data) => {\r\n      return Promise.resolve;\r\n    });\r\n};\r\n\r\nfunction handleResponse(response) {\r\n  return response.text().then((text) => {\r\n    const data = text && JSON.parse(text);\r\n    return data;\r\n  });\r\n}\r\n\r\nexport const authService = {\r\n  login,\r\n  logout,\r\n  checkAuth,\r\n};\r\n"]},"metadata":{},"sourceType":"module"}